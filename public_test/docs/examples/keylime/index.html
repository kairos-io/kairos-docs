<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Keylime agent | Kairos</title>
<meta name="description" content="This section describes an example on how to create a custom derivative with the Keylime agent">
<meta property="og:url" content="https://kairos.io/docs/examples/keylime/">
  <meta property="og:site_name" content="Kairos">
  <meta property="og:title" content="Keylime agent">
  <meta property="og:description" content="This section describes an example on how to create a custom derivative with the Keylime agent">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:modified_time" content="2025-10-20T08:48:34+03:00">
    <meta property="og:image" content="https://kairos.io/images/Kairos_800x419.png">

  <meta itemprop="name" content="Keylime agent">
  <meta itemprop="description" content="This section describes an example on how to create a custom derivative with the Keylime agent">
  <meta itemprop="dateModified" content="2025-10-20T08:48:34+03:00">
  <meta itemprop="wordCount" content="2829">
  <meta itemprop="image" content="https://kairos.io/images/Kairos_800x419.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://kairos.io/images/Kairos_800x419.png">
  <meta name="twitter:title" content="Keylime agent">
  <meta name="twitter:description" content="This section describes an example on how to create a custom derivative with the Keylime agent">
      <meta name="twitter:site" content="@Kairos_OSS">
<link rel="preload" href="/scss/main.scss" as="style" integrity="" crossorigin="anonymous">
<link href="/scss/main.scss" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
<script defer data-domain="kairos.io" src="https://plausible.io/js/script.outbound-links.tagged-events.js"></script>
<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>

<script type="module" src="/js/kairos.9086b05855f0beebae6a1adfe52a8db6351e5ad523c65f8ebdad68dcf69ccd751e3d4dd95553ca3ae13ebc022f180f2d00bda9e0402704807a6d02fb14ca0381.js" integrity="sha512-kIawWFXwvuuuahrf5SqNtjUeWtUjxl&#43;Ova1o3PaczXUePU3ZVVPKOuE&#43;vAIvGA8tAL2p4EAnBIB6bQL7FMoDgQ==" defer></script>
<script async defer src="https://buttons.github.io/buttons.js"></script>

  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg width="30" height="30" viewBox="0 0 137 137" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24.8171" height="24.8171" transform="matrix(-0.86601 0.500028 -3.18907e-05 1 68.502 18.8594)" fill="#EE5007"/><rect width="24.8171" height="24.8171" transform="matrix(-0.86601 -0.500028 3.18907e-05 1 47.0088 31.2695)" fill="#FF7442"/><rect width="24.8171" height="24.8171" transform="matrix(-0.866041 0.499972 0.866041 0.499972 47.0088 6.45312)" fill="#FB9E70"/><rect width="24.8171" height="24.8171" transform="matrix(3.19859e-05 1 0.86601 0.500028 25.5139 43.6797)" fill="#FF7442"/><rect width="24.8171" height="24.8171" transform="matrix(-0.866041 0.499973 0.866041 0.499972 25.5139 68.4922)" fill="#FB9E70"/><rect width="24.8171" height="24.8171" transform="matrix(-3.17834e-05 1 0.866009 -0.500028 4.02271 56.0898)" fill="#EE5007"/><rect width="24.8171" height="24.8171" transform="matrix(-0.86601 0.500028 -3.19781e-05 1 68.5042 93.3125)" fill="#EE5007"/><rect width="24.8171" height="24.8171" transform="matrix(-0.866009 -0.500028 3.18033e-05 1 47.011 105.723)" fill="#FF7442"/><rect width="24.8171" height="24.8171" transform="matrix(-0.866041 0.499972 0.866041 0.499973 47.011 80.9062)" fill="#FB9E70"/><rect width="24.8171" height="24.8171" transform="matrix(0.86601 -0.500028 3.18907e-05 -1 68.4985 118.141)" fill="#EE5007"/><rect width="24.8171" height="24.8171" transform="matrix(0.86601 0.500028 -3.18907e-05 -1 89.9917 105.73)" fill="#FF7442"/><rect width="24.8171" height="24.8171" transform="matrix(0.866041 -0.499972 -0.866041 -0.499972 89.9917 130.547)" fill="#FB9E70"/><rect width="24.8171" height="24.8171" transform="matrix(-0.86601 0.500028 -3.19781e-05 1 132.979 56.0859)" fill="#EE5007"/><rect width="24.8171" height="24.8171" transform="matrix(-0.866009 -0.500028 3.18033e-05 1 111.486 68.4961)" fill="#FF7442"/><rect width="24.8171" height="24.8171" transform="matrix(-0.866041 0.499972 0.866041 0.499973 111.486 43.6797)" fill="#FB9E70"/><rect width="24.8171" height="24.8171" transform="matrix(0.86601 -0.500028 3.18907e-05 -1 68.5002 43.6875)" fill="#EE5007"/><rect width="24.8171" height="24.8171" transform="matrix(0.86601 0.500028 -3.18907e-05 -1 89.9934 31.2773)" fill="#FF7442"/><rect width="24.8171" height="24.8171" transform="matrix(0.866041 -0.499972 -0.866041 -0.499972 89.9934 56.0938)" fill="#FB9E70"/></svg></span><span class="navbar-brand__name">Kairos</span></a>
  
  <button class="navbar-burger d-lg-none ms-auto" id="navbar-burger" aria-label="Toggle navigation" type="button" style="background:none;border:none;outline:none;">
    <span style="display:block;width:30px;height:3px;background:#fff;margin:4px 0;"></span>
    <span style="display:block;width:30px;height:3px;background:#fff;margin:4px 0;"></span>
    <span style="display:block;width:30px;height:3px;background:#fff;margin:4px 0;"></span>
  </button>
  
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav" id="navbar-links">
      <li class="nav-item">
        <a class="nav-link" href="/getting-started/"><span>Getting Started</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/community/"><span>Community</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/blog/"><span>Blog</span></a>
      </li>
      <li class="nav-item dropdown">
        <button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id="distro-select" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" data-distro="rhel;roskylinux;9" aria-label="Toggle Flavor">
    Rockylinux 9
</button>
<ul class="dropdown-menu" aria-labelledby="bd-flavor-text">
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="alpine;alpine;3.19" aria-pressed="false">
        Alpine 3.19
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="debian;debian;bookworm" aria-pressed="false">
        Debian Bookworm
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="debian;debian;testing" aria-pressed="false">
        Debian Testing
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="rhel;fedora;40" aria-pressed="false">
        Fedora 40
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="opensuse;opensuse;leap-15.6" aria-pressed="false">
        openSUSE Leap-15.6
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="opensuse;opensuse;tumbleweed" aria-pressed="false">
        openSUSE Tumbleweed
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="rhel;rockylinux;9" aria-pressed="true">
        Rockylinux 9
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="ubuntu;ubuntu;24.10" aria-pressed="false">
        Ubuntu 24.10
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="ubuntu;ubuntu;24.04" aria-pressed="false">
        Ubuntu 24.04
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="ubuntu;ubuntu;22.04" aria-pressed="false">
        Ubuntu 22.04
        </button>
    </li>
    <li>
        <button type="button" class="dropdown-item d-flex align-items-center distro-option" data-distro="ubuntu;ubuntu;20.04" aria-pressed="false">
        Ubuntu 20.04
        </button>
    </li>
</ul> 
      </li>
      
      <li class="nav-item mr-4 mb-2 mb-lg-0 mt-lg-2 d-none d-lg-block">
        <li class="nav-item mr-4 mb-2 mb-lg-0 mt-lg-2">
    <a class="github-button" href="https://github.com/kairos-io/kairos" data-size="large" data-show-count="true" aria-label="Star kairos-io/kairos on GitHub">Star</a>
</li> 
      </li>
      <li class="td-light-dark-menu nav-item dropdown">
        <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="check2" viewBox="0 0 16 16">
    <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
  </symbol>
  <symbol id="circle-half" viewBox="0 0 16 16">
    <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
  </symbol>
  <symbol id="moon-stars-fill" viewBox="0 0 16 16">
    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
    <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
  </symbol>
  <symbol id="sun-fill" viewBox="0 0 16 16">
    <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
  </symbol>
</svg>

<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center"
        id="bd-theme"
        type="button"
        aria-expanded="false"
        data-bs-toggle="dropdown"
        data-bs-display="static"
        aria-label="Toggle theme (auto)">
  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg>
</button>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#sun-fill"></use></svg>
      Light
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"></use></svg>
      Dark
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
      <svg class="bi me-2 opacity-50"><use href="#circle-half"></use></svg>
      Auto
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
</ul>

      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.2cd40d81f421519107d8c788686e9696.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>


<style>
   
  @media (max-width: 991.98px) {
     
    .navbar-burger {
      position: fixed;
      top: 12px;
      right: 16px;
      z-index: 3000;
      background: none;
      border: none;
      outline: none;
      padding: 0;
      width: 48px;
      height: 48px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    #main_navbar {
      display: none;
    }
    #main_navbar.show-mobile-menu {
      display: block;
      position: fixed;
      top: 60px;  
      left: 0;
      width: 100vw;
      height: calc(100vh - 60px);  
      background: #03153A;
      z-index: 2000;
      overflow-y: auto;
      transition: all 0.3s;
    }
    #navbar-links {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      padding: 2rem 1.5rem;
      width: 100%;
      height: 100%;
    }
    #navbar-links .nav-item {
      margin-bottom: 1.5rem;
      width: 100%;
    }
    #navbar-links .nav-link {
      width: 100%;
      font-size: 1.25rem;
    }
     
    .td-navbar-nav-scroll .dropdown-menu {
      position: absolute !important;
      left: 0 !important;
      right: auto !important;
      top: 100% !important;
      bottom: auto !important;
      min-width: 200px;
      margin-top: 0.5rem !important;  
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .td-navbar-nav-scroll .nav-item.dropdown {
      position: relative !important;
    }
    .td-navbar-nav-scroll .nav-item.dropdown > .nav-link,
    .td-navbar-nav-scroll .nav-item.dropdown > a {
      margin-bottom: 0 !important;
      padding-bottom: 0 !important;
    }
  }
   
  @media (max-width: 991.98px) {
    #main_navbar.show-mobile-menu { display: block; }
  }
</style>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var burger = document.getElementById('navbar-burger');
    var navbar = document.getElementById('main_navbar');
    if (burger && navbar) {
      burger.addEventListener('click', function() {
        navbar.classList.toggle('show-mobile-menu');
      });
    }
  });
</script>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <div id="content-mobile">
  <form class="td-sidebar__search d-flex align-items-center">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.2cd40d81f421519107d8c788686e9696.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  </div>
  <div id="content-desktop"></div>
  <nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled" id="td-section-nav">
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li">
  <a href="/docs/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docs"><span class="">Documentation</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsannouncements-li">
  <a href="/docs/announcements/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsannouncements"><i class="fa-solid fa-bullhorn"></i><span class="">Announcements</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsinstallation-li">
  <a href="/docs/installation/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsinstallation"><i class="fa-regular fa-computer"></i><span class="">Installation</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationcheck-the-signatures-li">
  <a href="/docs/installation/check-the-signatures/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationcheck-the-signatures"><span class="">Check the Signatures</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationaws-li">
  <a href="/docs/installation/aws/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationaws"><span class="">Installation on AWS</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationinteractive-li">
  <a href="/docs/installation/interactive/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationinteractive"><span class="">Interactive</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationmanual-li">
  <a href="/docs/installation/manual/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationmanual"><span class="">Manual installation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationqrcode-li">
  <a href="/docs/installation/qrcode/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationqrcode"><span class="">QR Code</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationwebui-li">
  <a href="/docs/installation/webui/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationwebui"><span class="">WebUI</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationazure-li">
  <a href="/docs/installation/azure/" title="Installation on Microsoft Azure" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationazure"><span class="">Installation on Azure</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationgce-li">
  <a href="/docs/installation/gce/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationgce"><span class="">Installation on Google Cloud</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationautomated-li">
  <a href="/docs/installation/automated/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationautomated"><span class="">Automated</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationbare-metal-li">
  <a href="/docs/installation/bare-metal/" title="Installing on Bare-Metal" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationbare-metal"><span class="">Bare-Metal</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationnvidia_agx_orin-li">
  <a href="/docs/installation/nvidia_agx_orin/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationnvidia_agx_orin"><span class="">Nvidia AGX Orin</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationraspberry-li">
  <a href="/docs/installation/raspberry/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationraspberry"><span class="">RaspberryPi</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationnetboot-li">
  <a href="/docs/installation/netboot/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationnetboot"><span class="">Network booting</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationp2p-li">
  <a href="/docs/installation/p2p/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationp2p"><span class="">P2P support</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationtrustedboot-li">
  <a href="/docs/installation/trustedboot/" title="Trusted Boot Installations" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationtrustedboot"><span class="">Trusted Boot</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsinstallationtakeover-li">
  <a href="/docs/installation/takeover/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsinstallationtakeover"><span class="">Takeover</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsupgrade-li">
  <a href="/docs/upgrade/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsupgrade"><i class="fa-regular fa-cloud-arrow-up"></i><span class="">Upgrade</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsupgrademanual-li">
  <a href="/docs/upgrade/manual/" title="Manual Upgrades" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsupgrademanual"><span class="">Manual</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsupgradekubernetes-li">
  <a href="/docs/upgrade/kubernetes/" title="Upgrading from Kubernetes" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsupgradekubernetes"><span class="">From Kubernetes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsupgradekairos-operator-li">
  <a href="/docs/upgrade/kairos-operator/" title="Installing Kairos Operator" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsupgradekairos-operator"><span class="">Kairos Operator</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsupgradesystem-upgrade-controller-li">
  <a href="/docs/upgrade/system-upgrade-controller/" title="Installing system-upgrade-controller (Deprecated)" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsupgradesystem-upgrade-controller"><span class="">System Upgrade Controller (Deprecated)</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsupgradetrustedboot-li">
  <a href="/docs/upgrade/trustedboot/" title="Trusted Boot Upgrades" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsupgradetrustedboot"><span class="">Trusted Boot</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsupgradeboot_assessment-li">
  <a href="/docs/upgrade/boot_assessment/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsupgradeboot_assessment"><span class="">Boot assessment</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsarchitecture-li">
  <a href="/docs/architecture/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsarchitecture"><i class="fa-regular fa-diagram-project"></i><span class="">Architecture</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsarchitectureimmutable-li">
  <a href="/docs/architecture/immutable/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsarchitectureimmutable"><span class="">Immutable</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsarchitecturecontainer-li">
  <a href="/docs/architecture/container/" title="Container based" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsarchitecturecontainer"><span class="">Container</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsarchitecturesecureboot-li">
  <a href="/docs/architecture/secureboot/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsarchitecturesecureboot"><span class="">SecureBoot support</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsarchitecturecloud-init-li">
  <a href="/docs/architecture/cloud-init/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsarchitecturecloud-init"><span class="">Cloud init based</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsarchitecturemeta-li">
  <a href="/docs/architecture/meta/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsarchitecturemeta"><span class="">Meta-Distribution</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsarchitecturenetwork-li">
  <a href="/docs/architecture/network/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsarchitecturenetwork"><span class="">P2P Network</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsarchitecturetrustedboot-li">
  <a href="/docs/architecture/trustedboot/" title="Trusted Boot Architecture" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsarchitecturetrustedboot"><span class="">Trusted Boot</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsadvanced-li">
  <a href="/docs/advanced/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsadvanced"><i class="fa-regular fa-gear"></i><span class="">Advanced</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedafter-install-li">
  <a href="/docs/advanced/after-install/" title="Pushing configuration to a node after installation" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedafter-install"><span class="">After install</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedconfiguring_partitions-li">
  <a href="/docs/advanced/configuring_partitions/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedconfiguring_partitions"><span class="">Configuring partitions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedcreating_custom_cloud_images-li">
  <a href="/docs/advanced/creating_custom_cloud_images/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedcreating_custom_cloud_images"><span class="">Creating Custom Cloud Images</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedprivate_registry_auth-li">
  <a href="/docs/advanced/private_registry_auth/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedprivate_registry_auth"><span class="">Private registries authentication</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedcustomizing-li">
  <a href="/docs/advanced/customizing/" title="Customizing the system image" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedcustomizing"><span class="">Customization</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedbuild-li">
  <a href="/docs/advanced/build/" title="Build Kairos appliances" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedbuild"><span class="">Build</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedsys-extensions-li">
  <a href="/docs/advanced/sys-extensions/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedsys-extensions"><span class="">Extending the system with systemd extensions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancednetworking-li">
  <a href="/docs/advanced/networking/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancednetworking"><span class="">Networking</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedadding_opt_to_system_extensions-li">
  <a href="/docs/advanced/adding_opt_to_system_extensions/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedadding_opt_to_system_extensions"><span class="">Using /opt with System Extensions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedbundles-li">
  <a href="/docs/advanced/bundles/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedbundles"><span class="">Bundles</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedpartition_encryption-li">
  <a href="/docs/advanced/partition_encryption/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedpartition_encryption"><span class="">Encrypting User Data with Kairos</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedcoco-li">
  <a href="/docs/advanced/coco/" title="Confidential computing setup" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedcoco"><span class="">Confidential Computing</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsadvancedrevoking-secureboot-access-li">
  <a href="/docs/advanced/revoking-secureboot-access/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsadvancedrevoking-secureboot-access"><span class="">Revoking secure boot access</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docsexamples-li">
  <a href="/docs/examples/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsexamples"><i class="fa-regular fa-file"></i><span class="">Examples</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesboot_assessment_trusted_boot-li">
  <a href="/docs/examples/boot_assessment_trusted_boot/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesboot_assessment_trusted_boot"><span class="">Enabling Automatic Boot Assessment with Trusted Boot</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexampleskubeadm-provider-li">
  <a href="/docs/examples/kubeadm-provider/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexampleskubeadm-provider"><span class="">A Minimal Single-Node Kubernetes with Kubeadm</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesextra_persistent_paths_after_install-li">
  <a href="/docs/examples/extra_persistent_paths_after_install/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesextra_persistent_paths_after_install"><span class="">Adding persistent paths after install</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesairgap-li">
  <a href="/docs/examples/airgap/" title="How to Create an Airgap K3s Installation with Kairos" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesairgap"><span class="">Airgapped ISO</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesbandwidth-optimized-upgrades-li">
  <a href="/docs/examples/bandwidth-optimized-upgrades/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesbandwidth-optimized-upgrades"><span class="">Bandwidth Optimized Upgrades</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesbundles-li">
  <a href="/docs/examples/bundles/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesbundles"><span class="">Bundles</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplestrusted-boot-firmware-sysext-li">
  <a href="/docs/examples/trusted-boot-firmware-sysext/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplestrusted-boot-firmware-sysext"><span class="">Deploying kernel firmware via sysext on Trusted Boot</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexampleskdump-li">
  <a href="/docs/examples/kdump/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexampleskdump"><span class="">Enabling kdump</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesopenamt-li">
  <a href="/docs/examples/openamt/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesopenamt"><span class="">Intel Open AMT Registration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docsexampleskeylime-li">
  <a href="/docs/examples/keylime/" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id="m-docsexampleskeylime"><span class="td-sidebar-nav-active-item">Keylime agent</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexampleslocalai-li">
  <a href="/docs/examples/localai/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexampleslocalai"><span class="">LocalAI</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesmulti-node-li">
  <a href="/docs/examples/multi-node/" title="Manual Multi-Node Cluster" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesmulti-node"><span class="">Manual multi-node cluster</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesha-li">
  <a href="/docs/examples/ha/" title="Manual Multi-Node High Availability Cluster" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesha"><span class="">Manual multi-node HA cluster</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplessingle-node-li">
  <a href="/docs/examples/single-node/" title="Manual Single-Node Cluster" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplessingle-node"><span class="">Manual single-node cluster</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesmetallb-li">
  <a href="/docs/examples/metallb/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesmetallb"><span class="">MetalLB</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesp2p_e2e-li">
  <a href="/docs/examples/p2p_e2e/" title="P2P Multi-Node Cluster Provisioned via Netboot" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesp2p_e2e"><span class="">P2P multi-node cluster netboot</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesk3s-stages-li">
  <a href="/docs/examples/k3s-stages/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesk3s-stages"><span class="">Run stages along with K3s</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplessingle-node-p2p-li">
  <a href="/docs/examples/single-node-p2p/" title="Self-configured P2P Single-Node Cluster" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplessingle-node-p2p"><span class="">Self-configured P2P single-node cluster</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesmulti-node-p2p-li">
  <a href="/docs/examples/multi-node-p2p/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesmulti-node-p2p"><span class="">Self-coordinating P2P multi-node cluster</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesmulti-node-p2p-ha-li">
  <a href="/docs/examples/multi-node-p2p-ha/" title="Self-coordinating P2P Multi-Node Cluster with High Availability" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesmulti-node-p2p-ha"><span class="">Self-coordinating P2P multi-node cluster HA</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesmulti-node-p2p-ha-kubevip-li">
  <a href="/docs/examples/multi-node-p2p-ha-kubevip/" title="Self-coordinating P2P Multi-Node Cluster with High Availability and KubeVIP" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesmulti-node-p2p-ha-kubevip"><span class="">Self-coordinating P2P multi-node cluster HA with KubeVIP</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplesvirtual-box-li">
  <a href="/docs/examples/virtual-box/" title="Kairos&#39; Trusted Boot in Virtual Box" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesvirtual-box"><span class="">Trusted Boot in Virtual Box</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexamplescore-li">
  <a href="/docs/examples/core/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplescore"><span class="">Using Kairos Core Images as an Installer</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsexampleswifi-li">
  <a href="/docs/examples/wifi/" title="Configuring WiFi via Cloud-Config" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsexampleswifi"><span class="">WiFi</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsreference-li">
  <a href="/docs/reference/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsreference"><i class="fa-regular fa-book"></i><span class="">Reference</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferenceartifacts-li">
  <a href="/docs/reference/artifacts/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferenceartifacts"><span class="">Artifact Naming Convention</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencearchitecture-li">
  <a href="/docs/reference/architecture/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencearchitecture"><span class="">Architecture</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferenceauroraboot-li">
  <a href="/docs/reference/auroraboot/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferenceauroraboot"><span class="">AuroraBoot</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferenceconfiguration-li">
  <a href="/docs/reference/configuration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferenceconfiguration"><span class="">Configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencestage_modules-li">
  <a href="/docs/reference/stage_modules/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencestage_modules"><span class="">Stage modules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencekairosctl-li">
  <a href="/docs/reference/kairosctl/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencekairosctl"><span class="">kairosctl</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencereset-li">
  <a href="/docs/reference/reset/" title="Reset a node" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencereset"><span class="">Reset</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencekairos-factory-li">
  <a href="/docs/reference/kairos-factory/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencekairos-factory"><span class="">The Kairos Factory</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferenceimage_matrix-li">
  <a href="/docs/reference/image_matrix/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferenceimage_matrix"><span class="">Image support matrix</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencebuild-from-scratch-li">
  <a href="/docs/reference/build-from-scratch/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencebuild-from-scratch"><span class="">Build Kairos from scratch</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencebuild_raw_images_with_qemu-li">
  <a href="/docs/reference/build_raw_images_with_qemu/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencebuild_raw_images_with_qemu"><span class="">Build Raw images with QEMU</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencetroubleshooting-li">
  <a href="/docs/reference/troubleshooting/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencetroubleshooting"><span class="">Troubleshooting</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencerecovery_mode-li">
  <a href="/docs/reference/recovery_mode/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencerecovery_mode"><span class="">Recovery mode</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferenceentangle-li">
  <a href="/docs/reference/entangle/" title="Entangle CRDs" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferenceentangle"><span class="">Entangle</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencefaq-li">
  <a href="/docs/reference/faq/" title="FAQ" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencefaq"><span class="">Frequently asked questions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsreferencealerts-li">
  <a href="/docs/reference/alerts/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsreferencealerts"><span class="">Alerts Styling</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdevelopment-li">
  <a href="/docs/development/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsdevelopment"><i class="fa-regular fa-terminal"></i><span class="">Development</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsdevelopmentdevelopment-li">
  <a href="/docs/development/development/" title="Development notes" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsdevelopmentdevelopment"><span class="">Development</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsdevelopmentdebugging-station-li">
  <a href="/docs/development/debugging-station/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsdevelopmentdebugging-station"><span class="">Debugging station</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsdevelopmentnvidia-li">
  <a href="/docs/development/nvidia/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsdevelopmentnvidia"><span class="">Booting Kairos on Nvidia Jetson ARM</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmedia-li">
  <a href="/docs/media/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsmedia"><i class="fa-regular fa-circle-play"></i><span class="">Media</span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">
<a href="https://github.com/kairos-io/kairos-docs/tree/main/content/en/docs/Examples/keylime.md" class="td-page-meta--view td-page-meta__view" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
  <a href="https://github.com/kairos-io/kairos-docs/edit/main/content/en/docs/Examples/keylime.md" class="td-page-meta--edit td-page-meta__edit" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
  <a href="https://github.com/kairos-io/kairos-docs/new/main/content/en/docs/Examples?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child td-page-meta__child" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
  <a href="https://github.com/kairos-io/kairos-docs/issues/new?title=Keylime%20agent" class="td-page-meta--issue td-page-meta__issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
  <a href="https://github.com/kairos-io/kairos/issues/new" class="td-page-meta--project td-page-meta__project-issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
  
</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#extend-kairos">Extend Kairos</a></li>
    <li><a href="#using-a-runtime-policy">Using a runtime policy</a></li>
    <li><a href="#using-a-tpm-policy-instead">Using a TPM policy instead</a></li>
    <li><a href="#using-revocation-keys">Using revocation keys</a></li>
  </ul>
</nav>
      </div>
    
            

          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            





  
  <div class="pageinfo pageinfo-warning">
    <p>You are viewing the development docs which are in progress. There is no guarantee that the development documentation will be accurate, including instructions, links, and other information. For the latest stable documentation, click
      <a href="https://kairos.io//v3.5.2/docs" target="_blank">here</a>.</p>
  </div>


  


            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/docs/">Documentation</a></li>
  <li class="breadcrumb-item">
    <a href="/docs/examples/">Examples</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    Keylime agent</li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Keylime agent</h1>
	<div class="lead">This section describes an example on how to create a custom derivative with the Keylime agent</div>
	<header class="article-meta">
		
</header>
	<p>This example how to use Keylime with Kairos in order to provide verified measurement for runtime binaries or files in a Kairos system. This, for instance involve having measurements for specific files in the persistent portion of the disk, or the configuration directories.</p>
<p>Most of the steps are already covered in the <a href="https://keylime-docs.readthedocs.io/en/latest/">Keylime documentation</a>. Here we will cover the steps that are specific to Kairos.</p>
<h2 id="extend-kairos">Extend Kairos</h2>
<p>First of all we need to create a Kairos derivative with the keylime agent, in order to do this we use the <a href="https://kairos.io/docs/reference/kairos-factory/">Kairos factory process</a> where we will build our own OS derivative to bundle keylime-agent:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="line"><span class="cl"><span class="c"># Build the keylime agent</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s"> ubuntu:24.04 AS keylime-build</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> apt-get update <span class="o">&amp;&amp;</span> apt-get install -y --no-install-recommends ca-certificates git gcc libclang-dev libssl-dev libtss2-dev libzmq3-dev pkg-config rustup make <span class="o">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /keylime</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> git clone --depth <span class="m">1</span> --branch v0.2.7 https://github.com/keylime/rust-keylime.git /keylime<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Set up install destination dir so we can reuse the build artifacts for our Kairos image</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">DESTDIR</span><span class="o">=</span>/keylime-output<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> rustup default stable <span class="o">&amp;&amp;</span> make <span class="o">&amp;&amp;</span> make install<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Build the final image with the keylime agent copied over, only systemd supported for now</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s"> quay.io/kairos/rockylinux:9-core-amd64-generic-v3.4.1 AS default</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> --from<span class="o">=</span>keylime-build /keylime-output/ /<span class="err">
</span></span></span></code></pre></div><p>Then you can build your image with the agent on it:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker build -t kairos-keylime .
</span></span></code></pre></div><p>That will generate an artifact based on the Kairos image with the keylime-agent installed.</p>
<p>Then you need at a minimum the follow configuration in your cloud config:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c">#cloud-config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">install</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">auto</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">reboot</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">device</span><span class="p">:</span><span class="w"> </span><span class="l">/dev/vda</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">bind_mounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/var/lib/keylime</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">grub_options</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">extra_cmdline</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ima_appraise=fix ima_template=ima-ng ima_policy=custom&#34;</span><span class="w"> </span><span class="c"># custom policy will load it from /etc/ima/ima-policy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">stages</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">initramfs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Set user and password&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">users</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">kairos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">passwd</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kairos&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">groups</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span>- <span class="s2">&#34;admin&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">keylime</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">groups</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span>- <span class="s2">&#34;tss&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kairos-keylime&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">files</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Set default IMA policy</span><span class="w"> </span><span class="c"># In initramfs as the kernel will load it on rootfs pivot</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/etc/ima/ima-policy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="nt">permissions</span><span class="p">:</span><span class="w"> </span><span class="m">0644</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">                # PROC_SUPER_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0x9fa0
</span></span></span><span class="line"><span class="cl"><span class="sd">                # SYSFS_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0x62656572
</span></span></span><span class="line"><span class="cl"><span class="sd">                # DEBUGFS_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0x64626720
</span></span></span><span class="line"><span class="cl"><span class="sd">                # TMPFS_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0x01021994
</span></span></span><span class="line"><span class="cl"><span class="sd">                # RAMFS_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0x858458f6
</span></span></span><span class="line"><span class="cl"><span class="sd">                # SECURITYFS_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0x73636673
</span></span></span><span class="line"><span class="cl"><span class="sd">                # SELINUX_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0xf97cff8c
</span></span></span><span class="line"><span class="cl"><span class="sd">                # CGROUP_SUPER_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0x27e0eb
</span></span></span><span class="line"><span class="cl"><span class="sd">                # OVERLAYFS_MAGIC
</span></span></span><span class="line"><span class="cl"><span class="sd">                # when containers are used we almost always want to ignore them
</span></span></span><span class="line"><span class="cl"><span class="sd">                dont_measure fsmagic=0x794c7630
</span></span></span><span class="line"><span class="cl"><span class="sd">                # MEASUREMENTS
</span></span></span><span class="line"><span class="cl"><span class="sd">                # This covers regular binary execution (e.g., running an ELF file with execve).
</span></span></span><span class="line"><span class="cl"><span class="sd">                measure func=BPRM_CHECK
</span></span></span><span class="line"><span class="cl"><span class="sd">                # Captures JIT-executed or interpreted code and shared libraries mapped into memory with executable permission.
</span></span></span><span class="line"><span class="cl"><span class="sd">                measure func=FILE_MMAP mask=MAY_EXEC
</span></span></span><span class="line"><span class="cl"><span class="sd">                # Tracks all kernel modules loaded by root, which is crucial for maintaining kernel integrity.
</span></span></span><span class="line"><span class="cl"><span class="sd">                measure func=MODULE_CHECK uid=0
</span></span></span><span class="line"><span class="cl"><span class="sd">                # Measures all files that are read, written, or appended to.
</span></span></span><span class="line"><span class="cl"><span class="sd">                measure func=FILE_CHECK mask=MAY_READ
</span></span></span><span class="line"><span class="cl"><span class="sd">                measure func=FILE_CHECK mask=MAY_WRITE
</span></span></span><span class="line"><span class="cl"><span class="sd">                measure func=FILE_CHECK mask=MAY_APPEND</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">boot</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Set Keylime config&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">files</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/var/lib/keylime/cv_ca/cacert.crt</span><span class="w"> </span><span class="c"># This is the cert from the Keylime registrar/tenant server. The clients need to trust it.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">                -----BEGIN CERTIFICATE-----
</span></span></span><span class="line"><span class="cl"><span class="sd">                MIID8zCCAtugAwIBAgIBATANBgkqhkiG9w0BAQsFADBzMQswCQYDVQQGEwJVUzEm
</span></span></span><span class="line"><span class="cl"><span class="sd">                MCQGA1UEAwwdS2V5bGltZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxCzAJBgNVBAgM
</span></span></span><span class="line"><span class="cl"><span class="sd">                Ak1BMRIwEAYDVQQHDAlMZXhpbmd0b24xDjAMBgNVBAoMBU1JVExMMQswCQYDVQQL
</span></span></span><span class="line"><span class="cl"><span class="sd">                DAI1MzAeFw0yNTA3MDQwODIxMThaFw0zNTA3MDIwODIxMThaMHMxCzAJBgNVBAYT
</span></span></span><span class="line"><span class="cl"><span class="sd">                AlVTMSYwJAYDVQQDDB1LZXlsaW1lIENlcnRpZmljYXRlIEF1dGhvcml0eTELMAkG
</span></span></span><span class="line"><span class="cl"><span class="sd">                A1UECAwCTUExEjAQBgNVBAcMCUxleGluZ3RvbjEOMAwGA1UECgwFTUlUTEwxCzAJ
</span></span></span><span class="line"><span class="cl"><span class="sd">                BgNVBAsMAjUzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqdMRFikV
</span></span></span><span class="line"><span class="cl"><span class="sd">                w65U0B213Zscps3ODEXPkZgFFf5Uyv9Md9kV5zMSWk0Em/HTUUiixVz8o7+soK7f
</span></span></span><span class="line"><span class="cl"><span class="sd">                SZezKg8Je/Sy1eZlRLR7ijHQyHmFByMcHiBry8FhaHelP1bfUNVHY9PkTYX1i7Cb
</span></span></span><span class="line"><span class="cl"><span class="sd">                yXiSwD2x467Ao8KwZWNR01d9rDMwWSV73scddRt9hLaI8BWaTptpaC3tpQhvo4K9
</span></span></span><span class="line"><span class="cl"><span class="sd">                LrYsOxpgoFGyMU09Ds5BOqt5IaU3DkY2bfkSy6D9W4GVzk56u0RHevy6kTA6DARK
</span></span></span><span class="line"><span class="cl"><span class="sd">                wDYlo+z/mgylLZsxD+r5VwxLjoXT1e+M2T4H/F2T/FPh5BLNngXOfaJl0YP9amLM
</span></span></span><span class="line"><span class="cl"><span class="sd">                oopARJ04qKO5pwIDAQABo4GRMIGOMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYE
</span></span></span><span class="line"><span class="cl"><span class="sd">                FE3BrSsveBPSY5ct2MLvIobGDDtSMCsGA1UdHwQkMCIwIKAeoByGGmh0dHA6Ly9s
</span></span></span><span class="line"><span class="cl"><span class="sd">                b2NhbGhvc3Q6MzgwODAvY3JsMA4GA1UdDwEB/wQEAwIBBjAfBgNVHSMEGDAWgBRN
</span></span></span><span class="line"><span class="cl"><span class="sd">                wa0rL3gT0mOXLdjC7yKGxgw7UjANBgkqhkiG9w0BAQsFAAOCAQEACk//H5DDy/F6
</span></span></span><span class="line"><span class="cl"><span class="sd">                fqp7Ar3tWtTsrPiDmNo3P1w6u8dstuyfcfbHDi8HaN0YN2a837ya0eF4WzLIpo/b
</span></span></span><span class="line"><span class="cl"><span class="sd">                Ft4hNboGTIBQbcVsQ6sm6JY7ioI/eEiaHO0FeyIFfTy/oj00if5SZ1AT/cpumTCm
</span></span></span><span class="line"><span class="cl"><span class="sd">                NapygE7EZYzQU8VW1wLKZlOb0KvuBaLbfsfpFB05ZB1PYyxETTuZvs93vEs/huay
</span></span></span><span class="line"><span class="cl"><span class="sd">                HolE8pIl1eHE6fFcEeBtmnOGOMHHcITlmyjdzSuL/Z3aDmXxuQN5y/cyO2t3MQ24
</span></span></span><span class="line"><span class="cl"><span class="sd">                i100gwrCtRGLmJo4cTr/57/KO8PkSZaNhWuLOfzLggBMHL6uXUr2Q8FBgTc/hUaX
</span></span></span><span class="line"><span class="cl"><span class="sd">                AZTsa1FQAA==
</span></span></span><span class="line"><span class="cl"><span class="sd">                -----END CERTIFICATE-----</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="nt">permissions</span><span class="p">:</span><span class="w"> </span><span class="m">0644</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/etc/keylime/agent.conf.d/10-config.conf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">                [agent]
</span></span></span><span class="line"><span class="cl"><span class="sd">                ip = &#39;0.0.0.0&#39; # This is the IP the agent will listen on, change if needed
</span></span></span><span class="line"><span class="cl"><span class="sd">                registrar_ip = &#39;192.168.122.31&#39; # change to the keylime remote attestation server IP
</span></span></span><span class="line"><span class="cl"><span class="sd">                uuid = &#39;61388a67-baa4-4f2b-8221-d539b7b4d98b&#39; # Generate an uuid with `uuidgen` or similar</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="nt">permissions</span><span class="p">:</span><span class="w"> </span><span class="m">0640</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Set keylime owner to /var/lib/keylime&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">commands</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span>- <span class="l">chown -R keylime:keylime /var/lib/keylime</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">network</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Enable keylime_agent service&#34;</span><span class="w"> </span><span class="c"># This will request activation but does not ADD the node and starts attestation</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">systemctl</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">enable</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span>- <span class="l">keylime_agent</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">start</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span>- <span class="l">keylime_agent</span><span class="w">
</span></span></span></code></pre></div><p>Lets go a bit into detail of some of the options.</p>
<ul>
<li><code>bind_mounts</code>: This is required for the keylime-agent to store the keys and certificates. It needs to be persisted across reboots.</li>
<li><code>extra_cmdline</code>: This is required to enable the IMA appraisal in the kernel. This is required for keylime to work if you expect to use runtime attestation and a custom IMA policy.</li>
<li><code>users</code>: We add the keylime user as the default keylime agent service will drop privileges to this user. Has to have the <code>tss</code> group as well.</li>
<li><code>/etc/ima/ima-policy</code>: This is the custom IMA policy that the kernel will use. The one provided is just a generic example.</li>
<li><code>/var/lib/keylime</code> ownership: The keylime agent will need to write to this directory. It is important to set the correct ownership. We do it at the end so all the written files are owned by the keylime user.</li>
<li><code>systemctl</code>: We want to enable and start the keylime_agent service so it starts on boot and is running.</li>
<li><code>/etc/keylime/agent.conf.d/10-config.conf</code>: This is the keylime agent configuration. Keylime agent provides a default config and we use this to override those default values. Minimal values that need configuring here are as follows:
<ul>
<li><code>ip</code>: The IP address the agent will listen on. This should be set to <code>0.0.0.0</code> to listen on all interfaces or to the specific interface IP address if you know it on advance. Otherwise it will only listen on the loopback interface and won&rsquo;t be reachable from the outside.</li>
<li><code>registrar_ip</code>: The IP address of the keylime registrar server. Otherwise the agent will not be able to communicate with the registrar.</li>
<li><code>uuid</code>: The UUID of the agent. This is used to identify the agent in the registrar. This can be any UUID as long as it is unique in the registrar server. If you set it to &lsquo;generate&rsquo; it will generate a random UUID for you but that’s not currently supported in Kairos. You can generate a UUID with <code>uuidgen</code> or similar tools.</li>
<li><code>/var/lib/keylime/cv_ca/cacert.crt</code>: This is the CA certificate that the agent will use to verify the registrar server. This is required for the agent to be able to communicate with the registrar server securely. You can get this certificate from the Keylime registrar server.</li>
</ul>
</li>
</ul>
<p>With this values, building a derivative image and installing it should be enough to have the keylime agent running in Kairos.
Now you will need to add the agent to the Keylime registrar, as its currently activated but not added. You can do this from the Keylime tenant by running the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ keylime_tenant -c add --uuid UID_OF_AGENT --ip IP_OF_AGENT
</span></span><span class="line"><span class="cl">....
</span></span><span class="line"><span class="cl">2025-07-08 12:50:19.728 - keylime.tenant - INFO - Agent Info from Verifier <span class="o">(</span>127.0.0.1:8881<span class="o">)</span>:
</span></span><span class="line"><span class="cl"><span class="o">{</span><span class="s2">&#34;61388a67-baa4-4f2b-8221-d539b7b4d98b&#34;</span>: <span class="o">{</span><span class="s2">&#34;operational_state&#34;</span>: <span class="s2">&#34;Start&#34;</span>, <span class="s2">&#34;v&#34;</span>: null, <span class="s2">&#34;ip&#34;</span>: <span class="s2">&#34;192.168.122.47&#34;</span>, <span class="s2">&#34;port&#34;</span>: 9002, <span class="s2">&#34;tpm_policy&#34;</span>: <span class="s2">&#34;{\&#34;mask\&#34;: \&#34;0x0\&#34;}&#34;</span>, <span class="s2">&#34;meta_data&#34;</span>: <span class="s2">&#34;{}&#34;</span>, <span class="s2">&#34;has_mb_refstate&#34;</span>: 0, <span class="s2">&#34;has_runtime_policy&#34;</span>: 0, <span class="s2">&#34;accept_tpm_hash_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;sha512&#34;</span>, <span class="s2">&#34;sha384&#34;</span>, <span class="s2">&#34;sha256&#34;</span><span class="o">]</span>, <span class="s2">&#34;accept_tpm_encryption_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;ecc&#34;</span>, <span class="s2">&#34;rsa&#34;</span><span class="o">]</span>, <span class="s2">&#34;accept_tpm_signing_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;ecschnorr&#34;</span>, <span class="s2">&#34;rsassa&#34;</span><span class="o">]</span>, <span class="s2">&#34;hash_alg&#34;</span>: <span class="s2">&#34;&#34;</span>, <span class="s2">&#34;enc_alg&#34;</span>: <span class="s2">&#34;&#34;</span>, <span class="s2">&#34;sign_alg&#34;</span>: <span class="s2">&#34;&#34;</span>, <span class="s2">&#34;verifier_id&#34;</span>: <span class="s2">&#34;default&#34;</span>, <span class="s2">&#34;verifier_ip&#34;</span>: <span class="s2">&#34;127.0.0.1&#34;</span>, <span class="s2">&#34;verifier_port&#34;</span>: 8881, <span class="s2">&#34;severity_level&#34;</span>: null, <span class="s2">&#34;last_event_id&#34;</span>: null, <span class="s2">&#34;attestation_count&#34;</span>: 0, <span class="s2">&#34;last_received_quote&#34;</span>: 0, <span class="s2">&#34;last_successful_attestation&#34;</span>: 0<span class="o">}}</span>
</span></span><span class="line"><span class="cl">2025-07-08 12:50:19.728 - keylime.tenant - INFO - Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b <span class="o">(</span>192.168.122.47:9002<span class="o">)</span> added to Verifier <span class="o">(</span>127.0.0.1:8881<span class="o">)</span> after <span class="m">0</span> tries
</span></span></code></pre></div><p>Where <code>UID_OF_AGENT</code> is the UUID you set in the agent configuration and <code>IP_OF_AGENT</code> is the IP address of the agent.</p>
<blockquote>
<p>you can add <code>--cert default</code> to provision the node with the default certificates from the registrar, like the revocation certificat and such. This is very helpful so further steps down the line can be done without having to worry about the certificates.</p></blockquote>
<p>Now from the tenant you can apply any policy you want to the agent. Note that the agent will start the attestation but there is no actual policy applied by default, so it will not fail the attestation process. It will just continue to run and report its state as valid.</p>
<h2 id="using-a-runtime-policy">Using a runtime policy</h2>
<p>As an example, you can use <code>keylime-policy</code> to create a runtime policy that will be applied to the agent. This policy can be as simple or as complex as you want, depending on your security requirements.</p>
<blockquote>
<p>A runtime policy in its most basic form is a set of “golden” cryptographic hashes of files’ un-tampered state or of keys
that may be loaded onto keyrings for IMA verification</p></blockquote>
<p>Exclude list that excludes everything except the <code>/usr/local/</code> and <code>/oem/</code> directories (perfect for Kairos :D):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">^/(?!oem/|usr/local/)
</span></span></code></pre></div><p>Or an exclude list that just excludes the directories that are not relevant for the runtime policy (files that keep changing, like logs, temporary files, etc.):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">^/var/log
</span></span><span class="line"><span class="cl">.bash_history
</span></span><span class="line"><span class="cl">^/sys
</span></span><span class="line"><span class="cl">^/tmp
</span></span></code></pre></div><p>First from the node, we can copy the IMA ascii measure list and scp it to the Keylime tenant server:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ scp /sys/kernel/security/ima/ascii_runtime_measurements root@TENANT_IP:/root/runtime_measurements
</span></span></code></pre></div><p>Then on the tenant server, we can generate a policy from this list using the <code>keylime-policy</code> command. This command will create a policy based on the measurements in the file we just copied.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ keylime-policy create runtime --ima-measurement-list runtime_measurements -e excludelist.txt -o policy.json -v
</span></span><span class="line"><span class="cl">INFO:keylime.config:Reading configuration from <span class="o">[</span><span class="s1">&#39;/etc/keylime/logging.conf&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">2025-07-10 14:54:30.467 - keylime-policy - DEBUG - Measurement list is runtime_measurements
</span></span><span class="line"><span class="cl">2025-07-10 14:54:30.468 - keylime-policy - DEBUG - Using digest algorithm <span class="s1">&#39;sha256&#39;</span> obtained from the IMA measurement list
</span></span></code></pre></div><p>Now we can apply policy to the agent. You can use the <code>keylime_tenant</code> command to do this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">keylime_tenant --command update -u 61388a67-baa4-4f2b-8221-d539b7b4d98b -t 192.168.122.47 --runtime-policy policy.json 
</span></span><span class="line"><span class="cl">INFO:keylime.config:Reading configuration from <span class="o">[</span><span class="s1">&#39;/etc/keylime/logging.conf&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.578 - keylime.config - INFO - Reading configuration from <span class="o">[</span><span class="s1">&#39;/etc/keylime/tenant.conf&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.578 - keylime.config - INFO - Applied configuration snippets from /etc/keylime/tenant.conf.d
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.578 - keylime.tenant - INFO - Setting up client TLS...
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.578 - keylime.tenant - INFO - Using default client_cert option <span class="k">for</span> tenant
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.578 - keylime.tenant - INFO - Using default client_key option <span class="k">for</span> tenant
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.578 - keylime.tenant - INFO - No value provided in client_key_password option <span class="k">for</span> tenant, assuming the key is unencrypted
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.579 - keylime.tenant - INFO - TLS is enabled.
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.593 - keylime.cli.policies - INFO - TPM PCR Mask from policy is 0x0
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.643 - keylime.tenant - INFO - Agent Info from Verifier <span class="o">(</span>127.0.0.1:8881<span class="o">)</span>:
</span></span><span class="line"><span class="cl"><span class="o">{</span><span class="s2">&#34;61388a67-baa4-4f2b-8221-d539b7b4d98b&#34;</span>: <span class="o">{</span><span class="s2">&#34;operational_state&#34;</span>: <span class="s2">&#34;Terminated&#34;</span>, <span class="s2">&#34;v&#34;</span>: null, <span class="s2">&#34;ip&#34;</span>: <span class="s2">&#34;192.168.122.47&#34;</span>, <span class="s2">&#34;port&#34;</span>: 9002, <span class="s2">&#34;tpm_policy&#34;</span>: <span class="s2">&#34;{\&#34;mask\&#34;: \&#34;0x0\&#34;}&#34;</span>, <span class="s2">&#34;meta_data&#34;</span>: <span class="s2">&#34;{}&#34;</span>, <span class="s2">&#34;has_mb_refstate&#34;</span>: 0, <span class="s2">&#34;has_runtime_policy&#34;</span>: 0, <span class="s2">&#34;accept_tpm_hash_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;sha512&#34;</span>, <span class="s2">&#34;sha384&#34;</span>, <span class="s2">&#34;sha256&#34;</span><span class="o">]</span>, <span class="s2">&#34;accept_tpm_encryption_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;ecc&#34;</span>, <span class="s2">&#34;rsa&#34;</span><span class="o">]</span>, <span class="s2">&#34;accept_tpm_signing_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;ecschnorr&#34;</span>, <span class="s2">&#34;rsassa&#34;</span><span class="o">]</span>, <span class="s2">&#34;hash_alg&#34;</span>: <span class="s2">&#34;sha256&#34;</span>, <span class="s2">&#34;enc_alg&#34;</span>: <span class="s2">&#34;rsa&#34;</span>, <span class="s2">&#34;sign_alg&#34;</span>: <span class="s2">&#34;rsassa&#34;</span>, <span class="s2">&#34;verifier_id&#34;</span>: <span class="s2">&#34;default&#34;</span>, <span class="s2">&#34;verifier_ip&#34;</span>: <span class="s2">&#34;127.0.0.1&#34;</span>, <span class="s2">&#34;verifier_port&#34;</span>: 8881, <span class="s2">&#34;severity_level&#34;</span>: null, <span class="s2">&#34;last_event_id&#34;</span>: null, <span class="s2">&#34;attestation_count&#34;</span>: 78, <span class="s2">&#34;last_received_quote&#34;</span>: 1752066297, <span class="s2">&#34;last_successful_attestation&#34;</span>: 1752066297<span class="o">}}</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span><span class="s1">&#39;code&#39;</span>: 200, <span class="s1">&#39;status&#39;</span>: <span class="s1">&#39;Success&#39;</span>, <span class="s1">&#39;results&#39;</span>: <span class="o">{</span><span class="s1">&#39;quote&#39;</span>: <span class="s1">&#39;r/1RDR4AYACIAC4hWOYdkG4M3v+tpIFyj2HOcpM/hnxJNsfc3rT9r4S5BABRkWnVQd1Rja3VPUjlBeUhyeWRPagAAAAAF6sI1AAAABgAAAAABICQBJQASAAAAAAABAAsDAAABACBYQwK8jVUDbMvZmLPw0tE7unP+d4sVDS8/pqmkT+gkag==:ABQACwEACQih/HZ/9JO3/hCwGmE6LSojc/nYQgskf4t/6OGB3ed/3kyysUMYrSXtw38FoZA+uu/7YTEaW+qWzf/KVPjOU5GJUB1B2StdSv570hTps7InxxDXhphIFH/KI5f1OdEK5c8o09b/IpZ/nGdYmp3GnowAivm+9y/0xarRA5GMUiVWdJT7LhZMQvxRXG/Yhb5zwoewpFecmbcNZ7/t0qpFfEpifwhP/yhp1wPTdUds774hlPhy5PAXFFYnTVcDn8TN0a8tBENtA/tewx3i6pxhIggW/miNyzgdKrQyIBCXgYr8U8zykk0DjTnWVeML3lzEj3CGZ1HTmu3l512juxv32A==:AQAAAAsAAwAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAgADOY31045T1AWJQ9mnWd1S0uBPHVWocFH54zRICCX9KnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=&#39;</span>, <span class="s1">&#39;hash_alg&#39;</span>: <span class="s1">&#39;sha256&#39;</span>, <span class="s1">&#39;enc_alg&#39;</span>: <span class="s1">&#39;rsa&#39;</span>, <span class="s1">&#39;sign_alg&#39;</span>: <span class="s1">&#39;rsassa&#39;</span>, <span class="s1">&#39;pubkey&#39;</span>: <span class="s1">&#39;-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAm2R9EoaB0qhdKg+RbtJy\nYPbCM3CgxpnscdY0Eyv5WPfmkuJ9/9h/vWnqBDmxfXrZEhYlZIUrfyUjbNUyckz5\nXGgWpDZjNE+srxT7qwrUrCLpCvYSlHiLko6s4yinUKO0LPKQ1f41ATYd1JO3gXyD\nx8CabBqorSREz+KDO9uyUJyszL8lK0zLMAKXt/ZB3ZS76OmpmwBcQGpn0VtYHYl1\n584A4nStMIlNQET6QsQ70QIm5sTgaTGqrLoEHkQP7a1J9RfcHYrxqYg4dEgTEER7\nkPuLTKAGSdfqYzvOAIDqSsn3BxS1hC1TQ+ln6MprJSKG23VpMK1Q0PyTee7FvxVz\ntQIDAQAB\n-----END PUBLIC KEY-----\n&#39;</span><span class="o">}}</span>
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.849 - keylime.tenant - WARNING - DANGER: EK cert checking is disabled and no additional checks on EKs have been specified with ek_check_script option <span class="k">for</span> Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b <span class="o">(</span>192.168.122.47:9002<span class="o">)</span>. Keylime is not secure!!
</span></span><span class="line"><span class="cl">2025-07-09 15:20:42.849 - keylime.tenant - INFO - Quote from Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b <span class="o">(</span>192.168.122.47:9002<span class="o">)</span> validated
</span></span><span class="line"><span class="cl">2025-07-09 15:20:43.268 - keylime.tenant - INFO - Agent Info from Verifier default <span class="o">(</span>127.0.0.1:8881<span class="o">)</span>:
</span></span><span class="line"><span class="cl"><span class="o">{</span><span class="s2">&#34;61388a67-baa4-4f2b-8221-d539b7b4d98b&#34;</span>: <span class="o">{</span><span class="s2">&#34;operational_state&#34;</span>: <span class="s2">&#34;Start&#34;</span>, <span class="s2">&#34;v&#34;</span>: null, <span class="s2">&#34;ip&#34;</span>: <span class="s2">&#34;192.168.122.47&#34;</span>, <span class="s2">&#34;port&#34;</span>: 9002, <span class="s2">&#34;tpm_policy&#34;</span>: <span class="s2">&#34;{\&#34;mask\&#34;: \&#34;0x400\&#34;}&#34;</span>, <span class="s2">&#34;meta_data&#34;</span>: <span class="s2">&#34;{}&#34;</span>, <span class="s2">&#34;has_mb_refstate&#34;</span>: 0, <span class="s2">&#34;has_runtime_policy&#34;</span>: 1, <span class="s2">&#34;accept_tpm_hash_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;sha512&#34;</span>, <span class="s2">&#34;sha384&#34;</span>, <span class="s2">&#34;sha256&#34;</span><span class="o">]</span>, <span class="s2">&#34;accept_tpm_encryption_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;ecc&#34;</span>, <span class="s2">&#34;rsa&#34;</span><span class="o">]</span>, <span class="s2">&#34;accept_tpm_signing_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;ecschnorr&#34;</span>, <span class="s2">&#34;rsassa&#34;</span><span class="o">]</span>, <span class="s2">&#34;hash_alg&#34;</span>: <span class="s2">&#34;&#34;</span>, <span class="s2">&#34;enc_alg&#34;</span>: <span class="s2">&#34;&#34;</span>, <span class="s2">&#34;sign_alg&#34;</span>: <span class="s2">&#34;&#34;</span>, <span class="s2">&#34;verifier_id&#34;</span>: <span class="s2">&#34;default&#34;</span>, <span class="s2">&#34;verifier_ip&#34;</span>: <span class="s2">&#34;127.0.0.1&#34;</span>, <span class="s2">&#34;verifier_port&#34;</span>: 8881, <span class="s2">&#34;severity_level&#34;</span>: null, <span class="s2">&#34;last_event_id&#34;</span>: null, <span class="s2">&#34;attestation_count&#34;</span>: 0, <span class="s2">&#34;last_received_quote&#34;</span>: 0, <span class="s2">&#34;last_successful_attestation&#34;</span>: 0<span class="o">}}</span>
</span></span><span class="line"><span class="cl">2025-07-09 15:20:43.268 - keylime.tenant - INFO - Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b <span class="o">(</span>192.168.122.47:9002<span class="o">)</span> added to Verifier default <span class="o">(</span>127.0.0.1:8881<span class="o">)</span> after <span class="m">0</span> tries
</span></span></code></pre></div><p>This will apply the runtime policy to the agent and the agent will start the attestation process. You can see this in the agent logs:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Jul <span class="m">10</span> 12:55:39 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent                        &gt; GET invoked from <span class="s2">&#34;192.168.122.31&#34;</span> with uri /v2.1/quotes/integrity?nonce<span class="o">=</span>TMywGq9gEgYy8QaptsB1<span class="p">&amp;</span><span class="nv">mask</span><span class="o">=</span>0x400<span class="p">&amp;</span><span class="nv">partial</span><span class="o">=</span>1<span class="p">&amp;</span><span class="nv">ima_ml_entry</span><span class="o">=</span><span class="m">1739</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 12:55:39 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent::quotes_handler        &gt; GET integrity quote returning <span class="m">200</span> response
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 12:55:41 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent                        &gt; GET invoked from <span class="s2">&#34;192.168.122.31&#34;</span> with uri /v2.1/quotes/integrity?nonce<span class="o">=</span>eyI1bo2HpS081kM1FbnQ<span class="p">&amp;</span><span class="nv">mask</span><span class="o">=</span>0x400<span class="p">&amp;</span><span class="nv">partial</span><span class="o">=</span>1<span class="p">&amp;</span><span class="nv">ima_ml_entry</span><span class="o">=</span><span class="m">1739</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 12:55:42 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent::quotes_handler        &gt; GET integrity quote returning <span class="m">200</span> response
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 12:55:44 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent                        &gt; GET invoked from <span class="s2">&#34;192.168.122.31&#34;</span> with uri /v2.1/quotes/integrity?nonce<span class="o">=</span>3TStNCteiVm5NC0dCraW<span class="p">&amp;</span><span class="nv">mask</span><span class="o">=</span>0x400<span class="p">&amp;</span><span class="nv">partial</span><span class="o">=</span>1<span class="p">&amp;</span><span class="nv">ima_ml_entry</span><span class="o">=</span><span class="m">1739</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 12:55:44 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent::quotes_handler        &gt; GET integrity quote returning <span class="m">200</span> response
</span></span></code></pre></div><p>You can also check on the verifier logs that the agent is in the correct state:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">jul <span class="m">10</span> 14:57:06 keylime keylime_verifier<span class="o">[</span>1410<span class="o">]</span>: 2025-07-10 14:57:06.216 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b
</span></span><span class="line"><span class="cl">jul <span class="m">10</span> 14:57:08 keylime keylime_verifier<span class="o">[</span>1410<span class="o">]</span>: 2025-07-10 14:57:08.449 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b
</span></span><span class="line"><span class="cl">jul <span class="m">10</span> 14:57:10 keylime keylime_verifier<span class="o">[</span>1410<span class="o">]</span>: 2025-07-10 14:57:10.637 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b
</span></span><span class="line"><span class="cl">jul <span class="m">10</span> 14:57:12 keylime keylime_verifier<span class="o">[</span>1410<span class="o">]</span>: 2025-07-10 14:57:12.854 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b
</span></span></code></pre></div><p>Now we can test the revocation of the agent once a file is modified. We will change the /oem/90_custom.yaml and change a value in there:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sed -i <span class="s1">&#39;s/reboot: true/reboot: false/&#39;</span> /oem/90_custom.yaml
</span></span></code></pre></div><p>Sure enough, in a few seconds the agent will be revoked and you can see this in the verifier logs:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">jul <span class="m">10</span> 15:00:00 keylime keylime_verifier<span class="o">[</span>1410<span class="o">]</span>: 2025-07-10 15:00:00.941 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b
</span></span><span class="line"><span class="cl">jul <span class="m">10</span> 15:00:03 keylime keylime_verifier<span class="o">[</span>1410<span class="o">]</span>: 2025-07-10 15:00:03.153 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b
</span></span><span class="line"><span class="cl">jul <span class="m">10</span> 15:00:03 keylime keylime_verifier<span class="o">[</span>1410<span class="o">]</span>: 2025-07-10 15:00:03.153 - keylime.ima - WARNING - Hashes <span class="k">for</span> file /oem/90_custom.yaml don<span class="s1">&#39;t match 97356fb8edc035052bac594306d0fdcef99f28e42703acaafa8d7940868b60d0 not in [&#39;</span>046209cb4acb79d533a9c6a9845766d4f435bc059f45421ed6e1cceb9c2dcc2e<span class="s1">&#39;]
</span></span></span><span class="line"><span class="cl"><span class="s1">jul 10 15:00:03 keylime keylime_verifier[1410]: 2025-07-10 15:00:03.153 - keylime.ima - ERROR - IMA ERRORS: Some entries couldn&#39;</span>t be validated. Number of failures in modes: ImaNg 1.
</span></span><span class="line"><span class="cl">jul <span class="m">10</span> 15:00:03 keylime keylime_verifier<span class="o">[</span>1410<span class="o">]</span>: 2025-07-10 15:00:03.187 - keylime.verifier - WARNING - Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b failed, stopping polling
</span></span></code></pre></div><p>You can also see this in the agent logs:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Jul <span class="m">10</span> 13:00:02 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent                        &gt; GET invoked from <span class="s2">&#34;192.168.122.31&#34;</span> with uri /v2.1/quotes/integrity?nonce<span class="o">=</span>9Ovk0YVjEp2bXollI76m<span class="p">&amp;</span><span class="nv">mask</span><span class="o">=</span>0x400<span class="p">&amp;</span><span class="nv">partial</span><span class="o">=</span>1<span class="p">&amp;</span><span class="nv">ima_ml_entry</span><span class="o">=</span><span class="m">1746</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 13:00:02 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent::quotes_handler        &gt; GET integrity quote returning <span class="m">200</span> response
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 13:00:02 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent                        &gt; POST invoked from <span class="s2">&#34;192.168.122.31&#34;</span> with uri /v2.1/notifications/revocation
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 13:00:02 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  INFO  keylime_agent::notifications_handler &gt; Received revocation
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 13:00:02 localhost keylime_agent<span class="o">[</span>1551<span class="o">]</span>:  WARN  keylime_agent::revocation            &gt; Revocation certificate not yet available
</span></span></code></pre></div><h2 id="using-a-tpm-policy-instead">Using a TPM policy instead</h2>
<p>As an example, we add a policy that will only allow the agent to boot if the PCR 15 is equal to a specific value (in this case empty value as we haven&rsquo;t measured anything into PCR15):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ keylime_tenant -c update --uuid UID_OF_AGENT -t IP_OF_AGENT  --tpm_policy <span class="s1">&#39;{&#34;15&#34;:[&#34;0000000000000000000000000000000000000000&#34;,&#34;0000000000000000000000000000000000000000000000000000000000000000&#34;,&#34;000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#34;]}&#39;</span>
</span></span></code></pre></div><p>Then the agent will start the attestation process, which you can see both in the agent logs and in the verifier logs. As well as checking with the tenant that the agent is in the correct state.</p>
<p>Then to test the revocation you can extend the PCR15 manually:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ tpm2_pcrextend 15:sha256<span class="o">=</span>f1d2d2f924e986ac86fdf7b36c94bcdf32beec15324234324234234333333333
</span></span></code></pre></div><p>Then the verifier will see that the agent is not in the correct state and will revoke it. You can see this in the verifier logs:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">2025-07-10 15:05:15.296 - keylime.tenant - INFO - Agent Info from Verifier <span class="o">(</span>127.0.0.1:8881<span class="o">)</span>:
</span></span><span class="line"><span class="cl"><span class="o">{</span><span class="s2">&#34;61388a67-baa4-4f2b-8221-d539b7b4d98b&#34;</span>: <span class="o">{</span><span class="s2">&#34;operational_state&#34;</span>: <span class="s2">&#34;Invalid Quote&#34;</span>, <span class="s2">&#34;v&#34;</span>: null, <span class="s2">&#34;ip&#34;</span>: <span class="s2">&#34;192.168.122.47&#34;</span>, <span class="s2">&#34;port&#34;</span>: 9002, <span class="s2">&#34;tpm_policy&#34;</span>: <span class="s2">&#34;{\&#34;15\&#34;: [\&#34;0000000000000000000000000000000000000000\&#34;, \&#34;0000000000000000000000000000000000000000000000000000000000000000\&#34;, \&#34;000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\&#34;], \&#34;mask\&#34;: \&#34;0x8000\&#34;}&#34;</span>, <span class="s2">&#34;meta_data&#34;</span>: <span class="s2">&#34;{}&#34;</span>, <span class="s2">&#34;has_mb_refstate&#34;</span>: 0, <span class="s2">&#34;has_runtime_policy&#34;</span>: 0, <span class="s2">&#34;accept_tpm_hash_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;sha512&#34;</span>, <span class="s2">&#34;sha384&#34;</span>, <span class="s2">&#34;sha256&#34;</span><span class="o">]</span>, <span class="s2">&#34;accept_tpm_encryption_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;ecc&#34;</span>, <span class="s2">&#34;rsa&#34;</span><span class="o">]</span>, <span class="s2">&#34;accept_tpm_signing_algs&#34;</span>: <span class="o">[</span><span class="s2">&#34;ecschnorr&#34;</span>, <span class="s2">&#34;rsassa&#34;</span><span class="o">]</span>, <span class="s2">&#34;hash_alg&#34;</span>: <span class="s2">&#34;sha256&#34;</span>, <span class="s2">&#34;enc_alg&#34;</span>: <span class="s2">&#34;rsa&#34;</span>, <span class="s2">&#34;sign_alg&#34;</span>: <span class="s2">&#34;rsassa&#34;</span>, <span class="s2">&#34;verifier_id&#34;</span>: <span class="s2">&#34;default&#34;</span>, <span class="s2">&#34;verifier_ip&#34;</span>: <span class="s2">&#34;127.0.0.1&#34;</span>, <span class="s2">&#34;verifier_port&#34;</span>: 8881, <span class="s2">&#34;severity_level&#34;</span>: 6, <span class="s2">&#34;last_event_id&#34;</span>: <span class="s2">&#34;pcr_validation.invalid_pcr_15&#34;</span>, <span class="s2">&#34;attestation_count&#34;</span>: 53, <span class="s2">&#34;last_received_quote&#34;</span>: 1752152713, <span class="s2">&#34;last_successful_attestation&#34;</span>: 1752152711<span class="o">}}</span>
</span></span></code></pre></div><p>You will also see on the agent logs that it has been revoked:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Jul <span class="m">10</span> 13:05:13 localhost keylime_agent<span class="o">[</span>1741<span class="o">]</span>:  INFO  keylime_agent::quotes_handler  &gt; GET integrity quote returning <span class="m">200</span> response
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 13:05:13 localhost keylime_agent<span class="o">[</span>1741<span class="o">]</span>:  INFO  keylime_agent                  &gt; POST invoked from <span class="s2">&#34;192.168.122.31&#34;</span> with uri /v2.1/notifications/revocation
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 13:05:13 localhost keylime_agent<span class="o">[</span>1741<span class="o">]</span>:  INFO  keylime_agent::notifications_handler &gt; Received revocation
</span></span><span class="line"><span class="cl">Jul <span class="m">10</span> 13:05:13 localhost keylime_agent<span class="o">[</span>1741<span class="o">]</span>:  WARN  keylime_agent::revocation            &gt; Revocation certificate not yet available
</span></span></code></pre></div><h2 id="using-revocation-keys">Using revocation keys</h2>
<p>In order to make the agent revocation process more secure, when registering the agent in the Keylime tenant, you need to pass a <code>--cert YOURCERT|default</code> option when adding the node. This will create a secure payload with the proper keys and scripts to be used for revocation and deliver it to the node. The agent will then use this payload to revoke itself when it detects a policy violation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  DEBUG keylime_agent::keys_handler    &gt; Sent RunPayload message to payloads worker
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  DEBUG keylime_agent::keys_handler    &gt; Sent RunPayload message to payloads worker
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::payloads        &gt; Successfully decrypted payload
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::payloads        &gt; Wrote payload decryption key to <span class="s2">&#34;/var/lib/keylime/secure/unzipped/derived_tci_key&#34;</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::payloads        &gt; Wrote decrypted payload to <span class="s2">&#34;/var/lib/keylime/secure/unzipped/decrypted_payload&#34;</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::payloads        &gt; Unzipping payload decrypted_payload to <span class="s2">&#34;/var/lib/keylime/secure/unzipped&#34;</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::payloads        &gt; Payload init script indicated: autorun.sh
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::payloads        &gt; Running script: <span class="s2">&#34;/var/lib/keylime/secure/unzipped/autorun.sh&#34;</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::payloads        &gt; No payload script autorun.sh found in /var/lib/keylime/secure/unzipped
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  DEBUG keylime_agent::payloads        &gt; Sending PayloadDecrypted message to revocation worker
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::payloads        &gt; Successfully executed encrypted payload
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:22:12 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::revocation      &gt; Loading the revocation certificate from /var/lib/keylime/secure/unzipped/RevocationNotifier-cert.crt
</span></span></code></pre></div><p>The agent will use that certificate to confirm that the revocation order came from the Keylime tenant and not from an attacker. The agent will also use the revocation script to revoke itself, if any was configured.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Jul <span class="m">11</span> 07:32:07 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  INFO  keylime_agent::notifications_handler &gt; Received revocation
</span></span><span class="line"><span class="cl">Jul <span class="m">11</span> 07:32:07 localhost keylime_agent<span class="o">[</span>1756<span class="o">]</span>:  DEBUG keylime_agent::revocation            &gt; Revocation signature validated <span class="k">for</span> revocation: <span class="o">{</span><span class="s2">&#34;agent_id&#34;</span>:<span class="s2">&#34;61388a67-baa4-4f2b-8221-d539b7b4d98b&#34;</span>,<span class="s2">&#34;context&#34;</span>:<span class="s2">&#34;{\&#34;message\&#34;: \&#34;Hash not found in runtime policy\&#34;, \&#34;got\&#34;: \&#34;97356fb8edc035052bac594306d0fdcef99f28e42703acaafa8d7940868b60d0\&#34;, \&#34;expected\&#34;: [\&#34;046209cb4acb79d533a9c6a9845766d4f435bc059f45421ed6e1cceb9c2dcc2e\&#34;]}&#34;</span>,<span class="s2">&#34;event_id&#34;</span>:<span class="s2">&#34;ima.validation.ima-ng.runtime_policy_hash&#34;</span>,<span class="s2">&#34;event_time&#34;</span>:<span class="s2">&#34;Fri Jul 11 09:32:08 2025&#34;</span>,<span class="s2">&#34;ip&#34;</span>:<span class="s2">&#34;192.168.122.47&#34;</span>,<span class="s2">&#34;meta_data&#34;</span>:<span class="s2">&#34;{\&#34;cert_serial\&#34;: 4, \&#34;subject\&#34;: \&#34;OU=53,O=MITLL,L=Lexington,ST=MA,CN=61388a67-baa4-4f2b-8221-d539b7b4d98b,C=US\&#34;}&#34;</span>,<span class="s2">&#34;port&#34;</span>:9002,<span class="s2">&#34;severity_label&#34;</span>:<span class="s2">&#34;emergency&#34;</span>,<span class="s2">&#34;tpm_policy&#34;</span>:<span class="s2">&#34;{\&#34;mask\&#34;: \&#34;0x400\&#34;}&#34;</span>,<span class="s2">&#34;type&#34;</span>:<span class="s2">&#34;revocation&#34;</span><span class="o">}</span>
</span></span></code></pre></div><p>This is a very basic example of how to use keylime in Kairos. You can extend this to use more complex policies and more complex attestation mechanisms.
As Keylime is a very flexible tool, you can use it in many different ways to secure your infrastructure. Here are some more links to the Keylime documentation to get you started:</p>
<ul>
<li><a href="https://keylime-docs.readthedocs.io/en/latest/">Keylime documentation</a></li>
<li><a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/security_hardening/assembly_ensuring-system-integrity-with-keylime_security-hardening">Red Hat Keylime documentation</a></li>
<li><a href="https://documentation.suse.com/sle-micro/6.0/html/Micro-keylime/index.html">Suse Keylime documentation</a></li>
</ul>

	<div class="td-page-meta__lastmod">
  Last modified October 20, 2025: <a href="https://github.com/kairos-io/kairos-docs/commit/666b69577ba312ec0edb951f4a1e5633c9755c5a">Fix missing closing code-block (666b695)</a>
</div>

</div>


          </main>
        </div>
      </div>
      <footer class="row d-print-none">
    <div id="footer-content">
        <div>
            <div class="footer-logo">
                
                <img src="/index/footer-logo.png" alt="Kairos Logo" loading="lazy">
                <div class="footer-text">Project supported by <a href="https://spectrocloud.com" target="_blank"> <img src="/img/spectrocloud-dark.svg" class="sclogo" loading="lazy" width="192" height="51" alt="Spectro-Cloud-logo"> </a></div>
            </div>
            <div class="footer-follow-us">Follow us
                <div>
                    <a href="https://www.linkedin.com/company/kairos-oss/" target="_blank">
                        <i class="fa-brands fa-linkedin"></i>
                    </a>
                    <a href="https://github.com/kairos-io/kairos" target="_blank">
                        <i class="fa-brands fa-github"></i>
                    </a>
                    <a href="https://www.youtube.com/@Kairos-IO" target="_blank">
                        <i class="fa-brands fa-youtube"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</footer>

    </div>
    <script src="/js/main.min.bf0cab613e991fc11bc28a4a07b0aedef47c7c7c2595703ac3adf962fd6a8099.js" integrity="sha256-vwyrYT6ZH8EbwopKB7Cu3vR8fHwllXA6w635Yv1qgJk=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js" integrity="sha256-c0eKfUgHaYrtfjVesj&#43;YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>